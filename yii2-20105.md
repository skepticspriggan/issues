# [Fix error summary always visible with CSP header (#19691)](https://github.com/yiisoft/yii2/pull/20105)

- _Type:_ Pull Request
- _State:_ closed
- _Repository:_ `yii2`
- _Created at:_ 2024-01-18 15:52:07

| Q             | A
| ------------- | ---
| Is bugfix?    | y
| New feature?  | n
| Breaks BC?    | n
| Fixed issues  | #19691 

The issue is fixed by allowing the user to specify a HTML class for an empty error summary. The CSS style corresponding to the class can be set locally in the user's project.

## Comments

codecov[bot] on 2024-01-18 15:56

> ## [Codecov](https://app.codecov.io/gh/yiisoft/yii2/pull/20105?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=yiisoft) Report
All modified and coverable lines are covered by tests :white_check_mark:
> Comparison is base [(`60ea174`)](https://app.codecov.io/gh/yiisoft/yii2/commit/60ea174348a16249e79c73d1de86b47c6d594a7f?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=yiisoft) 48.02% compared to head [(`32a20f9`)](https://app.codecov.io/gh/yiisoft/yii2/pull/20105?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=yiisoft) 47.56%.


<details><summary>Additional details and impacted files</summary>


```diff
@@            Coverage Diff             @@
##           master   #20105      +/-   ##
==========================================
- Coverage   48.02%   47.56%   -0.46%     
==========================================
  Files         445      445              
  Lines       43889    43410     -479     
==========================================
- Hits        21077    20650     -427     
+ Misses      22812    22760      -52     
```



</details>

[:umbrella: View full report in Codecov by Sentry](https://app.codecov.io/gh/yiisoft/yii2/pull/20105?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=yiisoft).   
:loudspeaker: Have feedback on the report? [Share it here](https://about.codecov.io/codecov-pr-comment-feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=yiisoft).

## Reviews

samdark on 2025-11-07 00:00

framework/helpers/BaseHtml.php

@@ -1271,12 +1272,17 @@ public static function errorSummary($models, $options = [])
         $footer = ArrayHelper::remove($options, 'footer', '');
         $encode = ArrayHelper::remove($options, 'encode', true);
         $showAllErrors = ArrayHelper::remove($options, 'showAllErrors', false);
+        $emptyClass = ArrayHelper::remove($options, 'emptyClass', null);
         unset($options['header']);
         $lines = self::collectErrors($models, $encode, $showAllErrors);
         if (empty($lines)) {
             // still render the placeholder for client-side validation use
             $content = '<ul></ul>';
-            $options['style'] = isset($options['style']) ? rtrim($options['style'], ';') . '; display:none' : 'display:none';
+            if($emptyClass !== null) {

> ```suggestion
            if ($emptyClass !== null) {
```

samdark on 2025-11-07 00:00

framework/CHANGELOG.md

@@ -7,6 +7,7 @@ Yii Framework 2 Change Log
 - Bug #17181: Improved `BaseUrl::isRelative($url)` performance (sammousa, bizley, rob006)
 - Bug #17191: Fixed `BaseUrl::isRelative($url)` method in `yii\helpers\BaseUrl` (ggh2e3)
 - Bug #18469: Fixed `Link::serialize(array $links)` method in `yii\web\Link` (ggh2e3)
+- Bug #19691: Fix error summary always visible with CSP header (skepticspriggan)

> ```suggestion
- Bug #19691: Allow using custom class to style error summary (skepticspriggan)
```
